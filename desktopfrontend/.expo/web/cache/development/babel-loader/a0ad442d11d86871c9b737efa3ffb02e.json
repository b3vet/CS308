{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/atakansarac/Desktop/CS308/newrepo/desktopfrontend/src/pages/Login.js\";\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport { setUserSession, getUser, getRefreshToken, getAccessToken } from \"../utils/Common\";\nimport { Link, useLocation } from 'react-router-dom';\n\nfunction Login(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var username = useFormInput('');\n  var password = useFormInput('');\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var location = useLocation();\n\n  var handleLogin = function handleLogin() {\n    setError(null);\n    setLoading(true);\n    axios({\n      method: 'post',\n      url: 'http://127.0.0.1:8000/api/user/',\n      data: {\n        uname: username.value,\n        password: password.value\n      }\n    }).then(function (response) {\n      setLoading(false);\n      setUserSession(response.data.refresh, response.data.access, response.data.user);\n      console.log(getUser());\n      console.log(location.state);\n\n      if (location.state != null && location.state.toPurchase) {\n        props.history.push('/purchase', {\n          fromLogin: true\n        });\n      } else {\n        props.history.push('/');\n      }\n    }).catch(function (error) {\n      setLoading(false);\n\n      if (error.response) {\n        setError(error.response.status);\n      } else setError(error.message);\n    });\n  };\n\n  return React.createElement(\"div\", {\n    class: \"Login-Container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }\n  }, React.createElement(\"div\", {\n    class: \"Login-Float\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }\n  }), React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }\n  }), React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }\n  }, \"Username\", React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 17\n    }\n  }), React.createElement(\"input\", _extends({\n    type: \"text\"\n  }, username, {\n    autoComplete: \"new-password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }\n  }))), React.createElement(\"div\", {\n    style: {\n      marginTop: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }, \"Password\", React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 17\n    }\n  }), React.createElement(\"input\", _extends({\n    type: \"password\"\n  }, password, {\n    autoComplete: \"new-password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }))), error && React.createElement(React.Fragment, null, React.createElement(\"small\", {\n    style: {\n      color: 'red'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 19\n    }\n  }, error == 406 ? \"Invalid username or password!\" : \"Network error!\"), React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 124\n    }\n  })), React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 134\n    }\n  }), React.createElement(\"input\", {\n    class: \"Login-Button\",\n    type: \"button\",\n    value: loading ? 'Loading...' : 'Login',\n    onClick: handleLogin,\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }\n  }), React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 135\n    }\n  }), React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 141\n    }\n  }), React.createElement(Link, {\n    to: \"/register\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }\n  }, \"Don't have an account? Click here to register.\")));\n}\n\nvar useFormInput = function useFormInput(initialValue) {\n  var _useState5 = useState(initialValue),\n      _useState6 = _slicedToArray(_useState5, 2),\n      value = _useState6[0],\n      setValue = _useState6[1];\n\n  var handleChange = function handleChange(e) {\n    setValue(e.target.value);\n  };\n\n  return {\n    value: value,\n    onChange: handleChange\n  };\n};\n\nexport default Login;","map":{"version":3,"sources":["/Users/atakansarac/Desktop/CS308/newrepo/desktopfrontend/src/pages/Login.js"],"names":["React","useState","axios","setUserSession","getUser","getRefreshToken","getAccessToken","Link","useLocation","Login","props","loading","setLoading","username","useFormInput","password","error","setError","location","handleLogin","method","url","data","uname","value","then","response","refresh","access","user","console","log","state","toPurchase","history","push","fromLogin","catch","status","message","marginTop","color","initialValue","setValue","handleChange","e","target","onChange"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport { setUserSession, getUser, getRefreshToken, getAccessToken } from '../utils/Common';\r\nimport { Link, useLocation} from 'react-router-dom';\r\n\r\nfunction Login(props) {\r\n  const [loading, setLoading] = useState(false);\r\n  const username = useFormInput('');\r\n  const password = useFormInput('');\r\n  const [error, setError] = useState(null);\r\n  let location = useLocation();\r\n  // handle button click of login form\r\n  //post will change \r\n  //response may change\r\n  const handleLogin = () => {\r\n    setError(null);\r\n    setLoading(true);\r\n   axios({\r\n    method: 'post',\r\n    url: 'http://127.0.0.1:8000/api/user/',\r\n    data: {\r\n      uname: username.value,\r\n      password: password.value\r\n    }\r\n  }).then(\r\n    response => {\r\n      setLoading(false);\r\n      setUserSession(response.data.refresh, response.data.access, response.data.user);\r\n      console.log(getUser())\r\n      \r\n      console.log(location.state)\r\n      if(location.state != null && location.state.toPurchase) { \r\n          props.history.push('/purchase', {fromLogin: true});\r\n      }\r\n      else {\r\n        props.history.push('/');\r\n      }\r\n      \r\n    }\r\n  ).catch(\r\n    error => {\r\n      setLoading(false);\r\n      if (error.response) {\r\n        setError(error.response.status)\r\n      }\r\n      else setError(error.message);\r\n    }\r\n  )\r\n  }\r\n \r\n  return (\r\n    <div class=\"Login-Container\">\r\n    <div class=\"Login-Float\">\r\n      <br /><br />\r\n      <div>\r\n        Username<br />\r\n        <input type=\"text\" {...username} autoComplete=\"new-password\" />\r\n      </div>\r\n      <div style={{ marginTop: 10 }}>\r\n        Password<br />\r\n        <input type=\"password\" {...password} autoComplete=\"new-password\" />\r\n      </div>\r\n      {error && <><small style={{ color: 'red' }}>{error==406 ? \"Invalid username or password!\" : \"Network error!\"}</small><br /></>}<br />\r\n      <input class = \"Login-Button\" type=\"button\" value={loading ? 'Loading...' : 'Login'} onClick={handleLogin} disabled={loading} /><br /><br />\r\n      <Link to=\"/register\">Don't have an account? Click here to register.</Link>\r\n    </div>\r\n    </div>\r\n  );\r\n}\r\n \r\nconst useFormInput = initialValue => {\r\n  const [value, setValue] = useState(initialValue);\r\n \r\n  const handleChange = e => {\r\n    setValue(e.target.value);\r\n  }\r\n  return {\r\n    value,\r\n    onChange: handleChange\r\n  }\r\n}\r\n \r\nexport default Login;"]},"metadata":{},"sourceType":"module"}